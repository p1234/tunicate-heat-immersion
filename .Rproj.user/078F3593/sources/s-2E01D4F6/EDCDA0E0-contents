---
title: "Lab3_MessingAround"
author: "Hazel de Haas"m
date: "06/12/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
lab3data <- read.csv("Lab3Data.csv")
lab3dataV2 <- read.csv("Lab3DataV2.csv")
Urchin <- read.csv("Urchin.csv")

library(tidyr)
library(ggplot2)
library(fitdistrplus)
library(performance)
library(DHARMa)
library(gamlss)
library(FSA)
library(tidyverse)

l3data <- lab3data %>%
  rename(Algae_presence = Algae.presence)

l3data <- lab3data %>%
  rename(Algae_presence = Algae.presence)

l3data$treatment <- replace(l3data$treatment, l3data$treatment== "non_shock", "control" )

l3dataV2 <- lab3dataV2 %>%
  rename(Algae_presence = Algae.presence)

l3dataV2 <- lab3dataV2 %>%
  rename(Algae_presence = Algae.presence)

l3dataV2$treatment <- replace(l3dataV2$treatment, l3dataV2$treatment== "non_shock", "control" )
```

```{r}
Urchin$Treatment <- replace(Urchin$Treatment, Urchin$Treatment== "C", "control" )
Urchin$Treatment <- replace(Urchin$Treatment, Urchin$Treatment== "T", "osmotic shock" )

my_cols = c("Control" = "317873", "Osmotic Shock" = "a3c1ad")

ggplot(Urchin, aes(x = Treatment, y = Number, fill = Treatment))+
  labs(x = "Treatment", y = "Number of Algal Cells")+
  scale_fill_manual(values = c("#317873", "#a3c1ad"))+
  geom_boxplot()+
  theme_classic()


#stats for number of algal cells
hist(l3data$number_algae)
shapiro.test(l3data$number_algae)
#not normal - are we really surprised

t.test(number_algae ~ treatment, data = l3data, alternative = "two.sided", var.equal = F, conf.level = 0.95)
#p-value = 0.08491 not significant

#NEW stats for number of algal cells
hist(Urchin$Number)
shapiro.test(Urchin$Number)
#not normal - are we really surprised

t.test(Number ~ Treatment, data = Urchin, alternative = "two.sided", var.equal = F, conf.level = 0.95)
#p-value = 0.01857 significant

```

```{r}
#stats for presence of algal cells 
shapiro.test(l3data$Algae_presence)

fitDist(Algae_presence, data = l3data, type = "binom", try.gamlss = T)
#binomial 

l3data$treatment <- as.factor(l3data$treatment)

mod <- gamlss(Food ~ Treatment, family = BI, data = Urchin)
summary(mod)
#p = 0.0632 not significant

l3d <- l3data %>%
  na.omit(l3data)



kruskal.test(Algae_presence ~ treatment, data = l3d)
dunnTest(Algae_presence ~ treatment, data = l3d)
```


```{r}
ggplot(l3data, aes(x = treatment, y = Algae_presence))+
  labs(x = "Treatment", y = "Algae_presence")+
   geom_jitter(aes(colour = treatment), width = 0.05, height = 0.05)+
   theme_classic()
```

```{r}
ggplot(l3data, aes(x = treatment, y = Algae_presence))+
  labs(x = "Treatment", y = "Algae_presence")+
   geom_count(aes(colour = treatment, size = after_stat(prop)))+
  scale_size_area(max_size = 8)+
   theme_classic()
```

```{r}
l3d$Algae_presence <- as.factor(l3d$Algae_presence)

ggplot(l3data, aes(y=treatment, x= Algae_presence, colour = treatment)) + 
    geom_bar(position="dodge", stat="identity")

ggplot(l3dV2, aes(x=treatment, y= Feeding))+
   geom_jitter(aes(colour = treatment), width = 0.10, height = 0.10, size = 3)+
   labs(x = "Treatment", y = "Feeding")+ 
  theme_classic()

l3dV2 <- l3dataV2 %>%
  na.omit(l3dataV2)

  hist()
```

