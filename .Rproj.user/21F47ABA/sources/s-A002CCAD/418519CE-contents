---
title: "Bonus Boss Level Challenge"
author: "Lauren Gill"
date: "11/30/2021"
output: 
  pdf_document:
    toc: no
  html_document:
    df_print: kable
    toc: yes
    toc_float: yes
editor_options:
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, tidy=TRUE, tidy.opts = list(width.cutoff = 80))
```


### Libraries
```{r, message = FALSE}
library(gamlss)
library(fitdistrplus)
library(tidyverse)
library(ggplot2)
library(viridis)
```

### Modelling

Reading in data
```{r}
mydata <- read_delim("data.csv", delim = ',') %>% na.omit() %>%
  mutate(pop = as.factor(pop),
         sex = as.factor(sex))
str(mydata)
descdist(mydata$upper)
```
From cullen and Fray graph I can see that the dot of my observation is between the normal and uniform distribution, so I should test this

Now using `fitDist()` to automatically select an appropriate distribution, the function has selected SEP2 as the best distribution
```{r, warning = FALSE}
fitDist(upper, data = mydata, type = "realAll", try.gamlss = T)
```

Visualizing the distribution fits for the normal distribution (the distribution I want to test from the Cullen and Fray graph) and SEP2 distribution (chosen by fitDist)

```{r}
par(mfrow = c(1,2)) # sets our plot window to be 2 x 2 (instead of a single plot)
mSEP2 <- histDist(mydata$upper, "SEP2", density = T, main = "SEP2")
mNO <- histDist(mydata$upper, "NO", density = T, main = "Normal")

```

Both distributions look kind of similar, so now using GAIC

```{r}
GAIC(mNO, mSEP2)
```

The values are essentially within 2 points of each other, but since SEP2 has the lowest AIC value, I'll use that one!

Now making some models. Kept getting errors whenever I ran modSEP2, so did some research and added in mu.fix = TRUE which seemed to fix the errors

```{r, results='hide'}
modSEP2 <- gamlss(upper ~ growth*mass + sex*caught_prior + pop, family = SEP2(), 
                  data = mydata, 
                  control = gamlss.control(n.cyc = 150))

modNO <- gamlss(upper ~ pop + growth*mass + sex*caught_prior, family = NO(), data = mydata)
```

Now lets investigate the summaries
```{r}
summary(modSEP2)
summary(modNO)
```

The significant terms are pop (B), mass, and growth:mass. This is true for both of the models! The SEP2 model also found growth to be a signicant term (0.01202), but the normal model did not find that growth was significant (p = 0.0976)
Now to compare the models

```{r}
GAIC(modSEP2, modNO)
```
modSEP2 is better since its AIC value is lower!

### Visualizing the data

Using a boxplot
```{r}
my_cols = c("A" = "turquoise", "B" = "tomato")

ggplot(mydata, aes(x = pop, y = upper, fill = pop)) +
  geom_boxplot(colour = "magenta") +
  geom_jitter() +
  theme_classic()+
  labs(x = "", y = "Upper Limit (Â°C)")+
  theme(legend.position="none")+
  scale_fill_manual(values= my_cols)

```


