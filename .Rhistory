check_model(step.mod_changeweight)
shapiro.test(tuni_data1$survival)
tunidata <- read.csv("tunicate_master.csv")
shapiro.test(tuni_data1$survival)
shapiro.test(tuni_data$survival)
library(tidyverse)
library(cowplot)
library(ggplot2)
library(here)
setwd("~/Github/tunicate-heat-immersion")
tunidata <- read.csv("tunicate_master.csv")
shapiro.test(tuni_data$survival)
View(tunidata)
shapiro.test(tunidata$survival)
fitDist(survival, data = tuni_data1, type = "binom", try.gamlss = T)
library(tidyverse)
library(cowplot)
library(ggplot2)
library(here)
library(tidyr)
library(performance)
library(DHARMa)
library(fitdistrplus)
library(gamlss)
library(FSA)
library(goft)
library(MASS)
fitDist(survival, data = tuni_data1, type = "binom", try.gamlss = T)
fitDist(survival, data = tunidata, type = "binom", try.gamlss = T)
mod_survival <- gamlss(survival ~ water_type + temperature_c + exposure_time_s + water_type*temperature_c*exposure_time_s + random(as.factor(colony_id)), family = BI, data = tunidata)
summary(mod_survival)
step.modsurvival <- stepAIC(mod_survival, direction = "backward", trace = F)
summary(step.modsurvival)
formula(step.modsurvival)
gamlss(survival ~ water_type + temperature_c + exposure_time_s + water_type*temperature_c*exposure_time_s + random(as.factor(colony_id)), family = BI, data = tunidata)
summary(mod_survival)
step.modsurvival <- stepAIC(mod_survival, direction = "backward", trace = F)
summary(step.modsurvival)
formula(step.modsurvival)
mod_survival <- gamlss(survival ~ water_type + temperature_c + exposure_time_s + water_type*temperature_c*exposure_time_s, family = BI, data = tunidata)
summary(mod_survival)
step.modsurvival <- stepAIC(mod_survival, direction = "backward", trace = F)
summary(step.modsurvival)
formula(step.modsurvival)
View(tunidata)
step.modsurvival <- stepGAIC(mod_survival, direction = "backward", trace = F)
summary(step.modsurvival)
formula(step.modsurvival)
step.modsurvival <- stepGAIC(mod_survival, direction = "backward", trace = F)
formula(step.modsurvival)
dunnTest(survival ~ temperature_c, data = tuni_data1)
dunnTest(survival ~ temperature_c, data = tuni_data)
dunnTest(survival ~ temperature_c, data = tunidata)
mod_survival <- gamlss(survival ~ water_type + temperature_c + exposure_time_s + water_type*temperature_c*exposure_time_s + random(as.factor(colony_id)), family = BI, data = tunidata)
summary(mod_survival)
step.modsurvival <- stepGAIC(mod_survival, direction = "backward", trace = F)
formula(step.modsurvival)
tunidata <- read.csv("tunicate_master.csv")
tunidata <- read.csv("tunicate_master.csv")
tuni_data$temperature_c <- as.factor(tuni_data$temperature_c)
tuni_data$water_type <- as.factor(tuni_data$water_type)
tuni_data$exposure_time_s <- as.factor(tuni_data$exposure_time_s)
tuni_data$temperature_c <- as.factor(tunidata$temperature_c)
tuni_data$water_type <- as.factor(tunidata$water_type)
tuni_data$exposure_time_s <- as.factor(tunidata$exposure_time_s)
tunidata$temperature_c <- as.factor(tunidata$temperature_c)
tunidata$water_type <- as.factor(tunidata$water_type)
tunidata$exposure_time_s <- as.factor(tunidata$exposure_time_s)
mod_survival <- gamlss(survival ~ water_type + temperature_c + exposure_time_s + water_type*temperature_c*exposure_time_s + random(as.factor(colony_id)), family = BI, data = tunidata)
summary(mod_survival)
step.modsurvival <- stepGAIC(mod_survival, direction = "backward", trace = F)
formula(step.modsurvival)
dunnTest(survival ~ temperature_c, data = tunidata)
dunnTest(survival ~ temperature_c, data = tunidata)
dunnTest(survival ~ temperature_c, data = tunidata)
dunnTest(survival ~ temperature_c, data = tunidata)
dunnTest(survival ~ temperature_c, data = tunidata)
dunnTest(survival ~ temperature_c, data = tunidata)
dunnTest(survival ~ temperature_c, data = tunidata)
library(tidyverse)
library(cowplot)
library(ggplot2)
library(here)
library(tidyr)
library(performance)
library(DHARMa)
library(fitdistrplus)
library(gamlss)
library(FSA)
library(goft)
library(MASS)
tunidata <- read.csv("tunicate_master.csv")
tunidata$temperature_c <- as.factor(tunidata$temperature_c)
tunidata$water_type <- as.factor(tunidata$water_type)
tunidata$exposure_time_s <- as.factor(tunidata$exposure_time_s)
setwd("~/Github/tunicate-heat-immersion")
tunidata <- read.csv("tunicate_master.csv")
tunidata$temperature_c <- as.factor(tunidata$temperature_c)
tunidata$water_type <- as.factor(tunidata$water_type)
tunidata$exposure_time_s <- as.factor(tunidata$exposure_time_s)
mod_survival <- gamlss(survival ~ water_type + temperature_c + exposure_time_s + water_type*temperature_c*exposure_time_s + random(as.factor(colony_id)), family = BI, data = tunidata)
summary(mod_survival)
step.modsurvival <- stepGAIC(mod_survival, direction = "backward", trace = F)
summary(step.modsurvival)
formula(step.modsurvival)
#survival ~ temperature_c
dunnTest(survival ~ temperature_c, data = tunidata)
#Comparison        Z      P.unadj        P.adj
#1    12 - 50 2.817892 4.834013e-03 1.933605e-02*
#2    12 - 70 4.428115 9.506008e-06 5.703605e-05*
#3    50 - 70 1.610224 1.073490e-01 3.220471e-01
#4    12 - 90 4.428115 9.506008e-06 4.753004e-05*
#5    50 - 90 1.610224 1.073490e-01 2.146980e-01
#6    70 - 90 0.000000 1.000000e+00 1.000000e+00
#p-value for 12-90 and 12-70 is significant!
tuni_data1 <- tunidata %>% mutate(ChangeWetWeight = final_weight_g-post_acclimation_weight_g)
#Visualizing Data
p <- ggplot(tuni_data1, aes(x = exposure_time_s, y = ChangeWetWeight, fill = water_type))+
labs(x = "Exposure time (s)", y = "Change in wet weight (g)", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_boxplot()
p + facet_grid(cols = vars(temperature_c))
hist(tuni_data1$ChangeWetWeight)
shapiro.test(tuni_data1$ChangeWetWeight)
#p-value = 0.7646 thus follows a normal distribution!
descdist(tuni_data1$ChangeWetWeight)
#Statistics for Change in Weight after 3 Weeks
#Distribution Fitting
fitDist(ChangeWetWeight, data = tuni_data1, type = "realline", try.gamlss = T)
#this also gives normal distribution
#Linear Model
mod_changeweight <- lm(ChangeWetWeight ~ exposure_time_s + water_type + temperature_c + exposure_time_s*water_type*temperature_c, family = gaussian, data = tuni_data1)
summary(mod_changeweight)
#Model Selection
step.mod_changeweight <- stepAIC(mod_changeweight, direction = "backward", trace = F)
summary(step.mod_changeweight)
formula(step.mod_changeweight)
#ChangeWetWeight ~ water_type + temperature_c + water_type:temperature_c
check_model(step.mod_changeweight)
#check model when water_type:temperature_c was present and had major collinearity issues, thus removed water_type:temperature and check model again and collinearity issues were solved
mod_changeweightv2 <- lm(ChangeWetWeight ~ water_type + temperature_c, family = gaussian, data = tuni_data1)
summary(mod_changeweightv2)
#significant p-value for temperature_c90 (p=value = 0.0315)
fitDist(ChangeWetWeight, data = tuni_data1, type = "realline", try.gamlss = T)
setwd("~/Github/tunicate-heat-immersion")
library(tidyverse)
library(cowplot)
library(ggplot2)
library(here)
library(tidyr)
library(performance)
library(DHARMa)
library(fitdistrplus)
library(gamlss)
library(FSA)
library(goft)
library(MASS)
tunidata <- read.csv("tunicate_master.csv")
tunidata$temperature_c <- as.factor(tunidata$temperature_c)
tunidata$water_type <- as.factor(tunidata$water_type)
tunidata$exposure_time_s <- as.factor(tunidata$exposure_time_s)
tunirgb <- tunidata %>%
mutate(exposure_time_s = as.factor(exposure_time_s)) %>%
mutate(temperature_c = as.factor(temperature_c))
tunirgb <- tunirgb %>% mutate(deltachangergb = X48hr_rgb-initial_rgb)
p3 <- ggplot(tunirgb, aes(x = temperature_c, y = deltachangergb, fill = water_type))+
labs(x = "Temperature (°C)", y = "Change in Mean RGB", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_boxplot()
ggplot(tunirgb, aes(x = temperature_c, y = deltachangergb, fill = water_type))+
labs(x = "Temperature (°C)", y = "Change in Mean RGB", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_boxplot()
ggplot(tunirgb, aes(x = temperature_c, y = deltachangergb, fill = water_type))+
labs(x = "Temperature (°C)", y = "Change in Mean RGB", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_boxplot()+
theme_bw()
p3 + facet_grid(cols = vars(temperature_c))
ggplot(tunirgb, aes(x = temperature_c, y = deltachangergb, fill = water_type))+
labs(x = "Temperature (°C)", y = "Change in Mean RGB", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_boxplot()+
theme_bw()
ggplot(tunirgb, aes(x = temperature_c, y = deltachangergb, fill = water_type))+
labs(x = "Temperature (°C)", y = "Change in Mean RGB", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_boxplot(alpha = 0.5)+
theme_bw()
ggplot(tunirgb, aes(x = temperature_c, y = deltachangergb, fill = water_type))+
labs(x = "Temperature (°C)", y = "Change in Mean RGB", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_boxplot(alpha = 0.6)+
theme_bw()
ggplot(tunirgb, aes(x = temperature_c, y = deltachangergb, fill = water_type))+
labs(x = "Temperature (°C)", y = "Change in Mean RGB", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_boxplot(alpha = 0.6)+
theme_bw()
p <- ggplot(tuni_data1, aes(x = exposure_time_s, y = ChangeWetWeight, fill = water_type))+
labs(x = "Exposure time (s)", y = "Change in wet weight (g)", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_jitter(position = position_dodge(width=0.75))+
geom_boxplot(alpha = 0.5)+
theme_bw()
p + facet_grid(cols = vars(temperature_c))
p <- ggplot(tuni_data1, aes(x = exposure_time_s, y = ChangeWetWeight, fill = water_type))+
labs(x = "Exposure time (s)", y = "Change in wet weight (g)", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_jitter(position = position_dodge(width=0.75))+
geom_boxplot(alpha = 0.5)+
theme_bw()
p + facet_grid(cols = vars(temperature_c))
ggplot(tunirgb, aes(x = temperature_c, y = deltachangergb, fill = water_type))+
labs(x = "Temperature (°C)", y = "Change in Mean RGB", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_jitter(position = position_dodge(width=0.75))+
geom_boxplot(alpha = 0.6)+
theme_bw()
ggsave("deltachangergb")
ggsave('deltachangergb')
ggsave("deltachangergb.jpg")
setwd("~/Github/tunicate-heat-immersion")
library(tidyverse)
library(cowplot)
library(ggplot2)
library(here)
library(tidyr)
library(performance)
library(DHARMa)
library(fitdistrplus)
library(gamlss)
library(FSA)
library(goft)
library(MASS)
tunidata <- read.csv("tunicate_master.csv")
tunidata$temperature_c <- as.factor(tunidata$temperature_c)
tunidata$water_type <- as.factor(tunidata$water_type)
tunidata$exposure_time_s <- as.factor(tunidata$exposure_time_s)
p2 <- ggplot(tuni_data1, aes(x = exposure_time_s, y = ChangeWetWeight48, fill = water_type, ))+
labs(x = "Immersion time (s)", y = "Change in wet weight after 48hrs (g)", fill = "Water type")+
geom_boxplot(alpha = 0.5)+
theme_bw()
P3 <- p2 + facet_grid(cols = vars(temperature_c))
p6 <- ggplot(tuni_data1, aes(x = exposure_time_s, y = ChangeWetWeight48, fill = water_type, ))+
labs(x = "Immersion time (s)", y = "Change in wet weight after 48hrs (g)", fill = "Water type")+
geom_boxplot(alpha = 0.5)+
theme_bw()
p6 + facet_grid(cols = vars(temperature_c))
tuni_data1 <- tuni_data1 %>% mutate(ChangeWetWeight48 = `48hr_weight`-post_acclimation_weight_g)
View(tunidata)
tuni_data1 <- tuni_data1 %>% mutate(ChangeWetWeight48 = `X48hr_weight`-post_acclimation_weight_g)
p6 <- ggplot(tuni_data1, aes(x = exposure_time_s, y = ChangeWetWeight48, fill = water_type, ))+
labs(x = "Immersion time (s)", y = "Change in wet weight after 48hrs (g)", fill = "Water type")+
geom_boxplot(alpha = 0.5)+
theme_bw()
p6 + facet_grid(cols = vars(temperature_c))
p6 <- ggplot(tuni_data1, aes(x = exposure_time_s, y = ChangeWetWeight48, fill = water_type, ))+
labs(x = "Immersion time (s)", y = "Change in wet weight after 48hrs (g)", fill = "Water type")+
geom_boxplot(alpha = 0.6)+
theme_bw()
p6 + facet_grid(cols = vars(temperature_c))
p <- ggplot(tuni_data1, aes(x = exposure_time_s, y = ChangeWetWeight, fill = water_type))+
labs(x = "Exposure time (s)", y = "Change in wet weight after 3wks (g)", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_jitter(position = position_dodge(width=0.75))+
geom_boxplot(alpha = 0.6)+
theme_bw()
p4 <- p + facet_grid(cols = vars(temperature_c))
p4 + p3 + plot_layout(ncol=1)
p2 <- ggplot(tuni_data1, aes(x = exposure_time_s, y = ChangeWetWeight48, fill = water_type, ))+
labs(x = "Immersion time (s)", y = "Change in wet weight after 48hrs (g)", fill = "Water type")+
geom_boxplot(alpha = 0.6)+
theme_bw()
p3 <- p2 + facet_grid(cols = vars(temperature_c))
p4 + p3 + plot_layout(ncol=1)
library(patchwork)
p4 + p3 + plot_layout(ncol=1)
p <- ggplot(tuni_data1, aes(x = exposure_time_s, y = ChangeWetWeight, fill = water_type))+
labs(x = "Immersion time (s)", y = "Change in wet weight after 3wks (g)", fill = "Water type")+
#labs(title = "Temperature (°C)")+
geom_boxplot(alpha = 0.6)+
theme_bw()
p4 <- p + facet_grid(cols = vars(temperature_c))
p2 <- ggplot(tuni_data1, aes(x = exposure_time_s, y = ChangeWetWeight48, fill = water_type, ))+
labs(x = "Immersion time (s)", y = "Change in wet weight after 48hrs (g)", fill = "Water type")+
geom_boxplot(alpha = 0.6)+
theme_bw()
p3 <- p2 + facet_grid(cols = vars(temperature_c))
p3 + p4 + plot_layout(ncol=1)
kruskal.test(survival ~ temperature_c, data = tunidata)
kruskal.test(attachment ~ temperature_c, data = tunidata)
kruskal.test(attachment ~ water_type, data = tunidata)
mod_changeweight <- lm(ChangeWetWeight ~ exposure_time_s + water_type + temperature_c + exposure_time_s*water_type*temperature_c, family = gaussian, data = tuni_data1)
summary(mod_changeweight)
step.mod_changeweight <- stepAIC(mod_changeweight, direction = "backward", trace = F)
summary(step.mod_changeweight)
formula(step.mod_changeweight)
check_model(step.mod_changeweight)
mod_changeweightv2 <- lm(ChangeWetWeight ~ water_type + temperature_c, family = gaussian, data = tuni_data1)
summary(mod_changeweightv2)
setwd("~/Github/tunicate-heat-immersion")
library(tidyverse)
library(cowplot)
library(patchwork)
library(ggplot2)
library(here)
library(tidyr)
library(performance)
library(DHARMa)
library(fitdistrplus)
library(gamlss)
library(FSA)
library(goft)
library(MASS)
tunidata <- read.csv("tunicate_master.csv")
tunidata$temperature_c <- as.factor(tunidata$temperature_c)
tunidata$water_type <- as.factor(tunidata$water_type)
tunidata$exposure_time_s <- as.factor(tunidata$exposure_time_s)
tuni_stacked = tunidata %>%
group_by(mold_cover, temperature_c, water_type, exposure_time_s) %>%
summarise(frequency = n())%>%
mutate(temperature_c=  as.factor(temperature_c))
ggplot(tuni_stacked, aes(y = frequency, x = temperature_c, fill = as.factor(mold_cover))) +
geom_bar(stat = "identity", position = "fill") +
facet_grid(as.factor(exposure_time_s) ~ water_type) +
labs(x ="Temperature (°C)", y = "Frequency")+
scale_fill_brewer(palette = "Oranges", direction=1) +
labs(fill = "Mold Cover") +
theme_cowplot()
descdist(tunidata$mold_cover)
fit <- fitDist(mold_cover, data = tunidata, type = "realAll", try.gamlss = T)
fit$fits
descdist(tunidata$mold_cover)
fit <- fitDist(mold_cover, data = tunidata, type = "realAll", try.gamlss = T)
fit$fits
mST1 <- histDist(tunidata$mold_cover, "ST1", density = T, main = "Skew t (Azzalini type 1)")
mNO <- histDist(tunidata$mold_cover, "NO", density = T, main = "Normal")
GAIC(mST1, mNO)
tunirgb$colony_id <- as.factor(tunirgb$colony_id)
tunirgb$mold_cover <- as.factor(tunirgb$mold_cover)
ordinalmodfull <- clmm2(mold_cover ~ water_type + temperature_c + exposure_time_s +
exposure_time_s*water_type*temperature_c,
random = colony_id, data = tunirgb, Hess = TRUE)
summary(ordinalmodfull)
library(tidyverse)
library(cowplot)
library(patchwork)
library(ggplot2)
library(here)
library(tidyr)
library(performance)
library(DHARMa)
library(fitdistrplus)
library(gamlss)
library(FSA)
library(goft)
library(MASS)
library(ordinal)
library('ordinal')
library("ordinal")
library(ordinal)
ordinalmodfull <- clmm2(mold_cover ~ water_type + temperature_c + exposure_time_s +
exposure_time_s*water_type*temperature_c,
random = colony_id, data = tunirgb, Hess = TRUE)
library(ordinal)
setwd("~/Github/tunicate-heat-immersion")
library(tidyverse)
library(cowplot)
library(patchwork)
library(ggplot2)
library(here)
library(tidyr)
library(performance)
library(DHARMa)
library(fitdistrplus)
library(gamlss)
library(FSA)
library(goft)
library(MASS)
library(ordinal)
install.packages(ordinal)
install.packages(ordinal)
install.packages('ordinal')
library(tidyverse)
library(cowplot)
library(patchwork)
library(ggplot2)
library(here)
library(tidyr)
library(performance)
library(DHARMa)
library(fitdistrplus)
library(gamlss)
library(FSA)
library(goft)
library(MASS)
library(ordinal)
tunidata <- read.csv("tunicate_master.csv")
tunidata$temperature_c <- as.factor(tunidata$temperature_c)
tunidata$water_type <- as.factor(tunidata$water_type)
tunidata$exposure_time_s <- as.factor(tunidata$exposure_time_s)
shapiro.test(tunidata$survival)
#p-value = 2.047e-15
fitDist(survival, data = tunidata, type = "binom", try.gamlss = T)
#family = BI (binomial)
mod_survival <- gamlss(survival ~ water_type + temperature_c + exposure_time_s + water_type*temperature_c*exposure_time_s + random(as.factor(colony_id)), family = BI, data = tunidata)
summary(mod_survival)
step.modsurvival <- stepGAIC(mod_survival, direction = "backward", trace = F)
summary(step.modsurvival)
formula(step.modsurvival)
#survival ~ temperature_c
kruskal.test(survival ~ temperature_c, data = tunidata)
#Kruskal-Wallis chi-squared = 26.171, df = 3, p-value = 8.781e-06
dunnTest(survival ~ temperature_c, data = tunidata)
#Comparison        Z      P.unadj        P.adj
#1    12 - 50 2.817892 4.834013e-03 1.933605e-02*
#2    12 - 70 4.428115 9.506008e-06 5.703605e-05*
#3    50 - 70 1.610224 1.073490e-01 3.220471e-01
#4    12 - 90 4.428115 9.506008e-06 4.753004e-05*
#5    50 - 90 1.610224 1.073490e-01 2.146980e-01
#6    70 - 90 0.000000 1.000000e+00 1.000000e+00
#p-value for 12-90 and 12-70 is significant!
library(tidyverse)
library(cowplot)
library(patchwork)
library(ggplot2)
library(here)
library(tidyr)
library(performance)
library(DHARMa)
library(fitdistrplus)
library(gamlss)
library(FSA)
library(goft)
library(MASS)
library(ordinal)
tunidata <- read.csv("tunicate_master.csv")
tunidata$temperature_c <- as.factor(tunidata$temperature_c)
tunidata$water_type <- as.factor(tunidata$water_type)
tunidata$exposure_time_s <- as.factor(tunidata$exposure_time_s)
stepmodweight48 <- stepGAIC(mod_weight, direction = "backward", trace = F)
mod_weight <- gamlss(ChangeWetWeight48 ~ water_type + temperature_c + exposure_time_s + water_type*temperature_c*exposure_time_s, family = LO, data = tuni_data1)
summary(mod_weight)
stepmodweight48 <- stepGAIC(mod_weight, direction = "backward", trace = F)
summary(stepmodweight48)
formula(stepmodweight48)
summary(stepmodweight48)
hist(tuni_data1$ChangeWetWeight)
shapiro.test(tuni_data1$ChangeWetWeight)
#p-value = 0.7646 thus follows a normal distribution!
descdist(tuni_data1$ChangeWetWeight)
fitDist(ChangeWetWeight, data = tuni_data1, type = "realline", try.gamlss = T)
#this also gives normal distribution
mod_changeweight <- lm(ChangeWetWeight ~ exposure_time_s + water_type + temperature_c + exposure_time_s*water_type*temperature_c, family = gaussian, data = tuni_data1)
summary(mod_changeweight)
#Model Selection
step.mod_changeweight <- stepAIC(mod_changeweight, direction = "backward", trace = F)
summary(step.mod_changeweight)
formula(step.mod_changeweight)
#ChangeWetWeight ~ water_type + temperature_c + water_type:temperature_c
check_model(step.mod_changeweight)
#check model when water_type:temperature_c was present and had major collinearity issues, thus removed water_type:temperature and check model again and collinearity issues were solved
mod_changeweightv2 <- lm(ChangeWetWeight ~ water_type + temperature_c, family = gaussian, data = tuni_data1)
summary(mod_changeweightv2)
#significant p-value for temperature_c90 (p=value = 0.0315)
